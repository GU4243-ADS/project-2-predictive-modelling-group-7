---
title: "SIFT"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("cluster")
library("reshape2")
library("flexclust")
library("gtools")
```

```{r feats}
source("../lib/feature.R")
system.time(sift_features <- sift_features.load("../data/train-features",new_data = TRUE))

source("../lib/train.R")
labels <- read.csv("../data/train_label.txt",header=F)
labels <- as.numeric(labels$V1)
labels <- labels-1
predict(fit_train$fit, newdata = dat_test, 
                  n.trees = fit_train$iter, type = "response")
system.time(gbm_sift <- gbm_train(sift_features[1:1800,],labels[1:1800]))

source("../lib/test.R")
gbm_test(gbm_sift,sift_features[1801:2000,])
```