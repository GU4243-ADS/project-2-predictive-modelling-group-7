---
title: "SIFT"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("cluster")
library("reshape2")
library("flexclust")
library("gtools")
library("gbm")
```

```{r feats}
source("../lib/feature.R")
system.time(sift_features <- sift_features.load("../data/train-features",new_data = TRUE))

source("../lib/train.R")
labels <- read.csv("../data/train_label.txt",header=F)
labels <- as.numeric(labels$V1)
labels <- labels-1

system.time(gbm_sift <- gbm_train(sift_features[1:1800,],labels[1:1800]))
labels
source("../lib/test.R")
gbm_test(gbm_sift,sift_features[1801:2000,])
pred <- predict(gbm_sift$fit, newdata = sift_features[1801:2000,], 
                  n.trees = gbm_sift$iter,type="response")
pred_labels <- round(pred)
sum(labels[1801:2000] - pred_labels == 0)/200
```